import random

def skpbConstrain(gen, list_skpb):
    pnow = 0
    for i in range(len(list_skpb)):
        # Fourth Constraint: Sesi SKPB dan jurusan minimal 1 jam
        if gen[2:4] == "SK":
            if abs(int(gen[12:15]) - int(list_skpb[i][12:15])) < 2:
                pnow = pnow + 1
                print("P: " + gen )
    return pnow

dosenPrefrensiDict = {'SD': ['101', '102', '103', '104', '201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404', '501', '502', '503', '504'], 'RA': ['105', '106', '107', '108', '109', '110', '205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410', '505', '506', '507', '508', '509', '510'], 'RM': ['101', '102', '103', '104', '201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404', '501', '502', '503', '504'], 'WS': ['105', '106', '107', '108', '205', '206', '207', '208', '305', '306', '307', '308', '405', '406', '407', '408', '505', '506', '507', '508'], 'TA': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'BM': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'BJ': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408'], 'BH': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'AM': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408'], 'HB': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', 
'509', '510'], 'HS': ['301', '302', '303', '304', '401', '402', '403', '404'], 'BS': ['105', '106', '107', '108', '109', '110', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410'], 'YP': ['205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410'], 'DP': ['201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404'], 'AR': ['301', '302', '303', '304', '305', '306', '307', '308'], 'RL': ['301', '302', '303', '304', '305', '306', '307', '308'], 'DS': ['105', '106', '107', '108', '205', '206', '207', '208', '305', '306', '307', '308', '405', '406', '407', '408'], 'FB': ['201', '202', '203', '204', '205', '206', '207', '208', 
'209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310'], 'AB': ['105', '106', '107', '108', '109', '110', '205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410', '505', '506', '507', '508', '509', '510'], 'IS': ['105', '106', '107', '108', '109', '110', '205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', 
'407', '408', '409', '410', '505', '506', '507', '508', '509', '510'], 'RR': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'AL': ['101', '102', 
'103', '104', '105', '106', '107', '108', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408'], 'MN': ['101', '102', '103', '104', '201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404', '501', '502', '503', '504'], 'MK': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', 
'301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'KR': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'SC': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'OJ': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'ML': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'RJ': ['205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410'], 'MR': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'RN': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', 
'205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410'], 'SR': ['205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310'], 'UY': ['209', '210', '309', '310', '409', '410'], 'DO': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'ST': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'DA': ['205', '206', '207', '208', '305', '306', '307', '308', '405', '406', '407', '408'], 'NS': ['301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'AY': ['209', '210'], 'CF': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'DH': ['105', '106', '107', '108', '109', '110', '305', '306', '307', '308', '309', '310', '505', '506', '507', '508', '509', '510'], 'HT': ['209', '210', '309', '310'], 'AW': ['201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'AS': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'BA': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'JL': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210'], 'VH': ['401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'DZ': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'HF': ['201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410'], 'SA': ['201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'DH ': ['101', 
'102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'IM': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'MM': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SF': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SW': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SI': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', 
'206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SM': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SS': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'UG': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', 
'404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SN': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510']}
def prefrensiConstraint(gen):
    qnow = 0
    print(gen)
    if gen[12:15] not in dosenPrefrensiDict[gen[0:2]]:
        qnow = qnow + 1
    return qnow
def main():
    data_ruangan=[
        "101",
        "102",
        "103",
        "104",
        "105",
        "501",
        "106",
        "107",
        "108",
        "301",
        "302",
        "111",
        "112"
    ]


# First number means # day of the week
# The rest is the session of the day
# Ex. 301 = Wednesday, Session 1
# Ex. 110 = Monday, Session 10
# A session means an hour, Session 1 starts from 7.00
# That means Sesssion 2 is 8.00, Session 3 is 9.00, and so on.
    sesi=[]
    for i in range(1,6):
        for j in range(1,10,2):
            temp_sesi=""
            if j < 10:
                sesi.append(str(i)+"0"+str(j))
            else:
                sesi.append(str(i)+str(j))
    individu = ['SDIF4201A301103', 'RAIF4201A501304', 'RAIF4201I104302', 'RAIF4947A101406', 'RMIF4602A302401', 'RMIF4602B101501', 'WSIF4201C108304', 'WSIF4201D102209', 'WSIF4201E105502', 'WSIF4402A302407', 'TAIF4201F301202', 'TAIF4201G102103', 'BMIF4402I111109', 'BJIF4402B101404', 'BJIF4602C102101', 'BHIF4602I101208', 'AMIF4402C301102', 'AMIF4402D302304', 
'HBIF4402E101507', 'HBIF4402F108104', 'HSIF4602D102501', 'HSIF4945A105402', 'BSIF4913A302502', 'BSIF4701A301101', 'BSIF4701I102401', 'BSIF4602E111205', 'YPIF4101A101306', 'YPIF4202A102404', 'YPIF4202B101504', 'DPIF4202C301204', 'DPIF4202I302406', 'DPIF4957A101105', 'ARIF4202D108307', 'ARIF4202E102109', 'RLIF4401A105101', 'RLIF4401B302405', 'RLIF4401C301109', 'RLIF4902A102306', 'DSIF4202F111109', 'DSIF4202G101407', 'DSIF4404A102508', 'FBIF4605A101509', 'FBIF4605B301301', 'FBIF4504A302208', 'FBIF4406A101205', 'FBIF4406B108103', 'ABIF4401D102305', 'ABIF4401I105207', 'ISIF4401F302501', 'ISIF4401G301102', 'ISIF4401H102106', 'ISIF4504I111109', 'RRIF4963A101101', 'ALIF4964F102404', 'ALIF4603A101201', 'ALIF4406C301305', 'ALIF4406I302203', 'MNIF4605C101104', 'MNIF4605I108508', 'MNIF4404B102207', 'MKIF4404I105508', 'MNIF4966A302301', 'KRIF4404C301104', 'KRTI4411A102507', 'SCIF4404D111103', 'SCIF4403I101206', 'SCTI4411B102409', 'OJIF4946A101103', 'MLIF4101A301106', 'RJIF4605D105206', 'RJIF4605E302501', 'MRIF4903A101105', 'RNIF4404E301303', 'SRIF4404F107104', 'RNIF4603B108209', 'RNIF4603C104202', 'UYIF4603D501402', 'UYIF4603E101404', 'DOIF4603F106306', 'RNIF4603I101103', 'STIF4406D104408', 'SRIF4406E104206', 'SRIF4406F105209', 'RJIF4971A302104', 'STIF4972A101507', 'DAIF4403A301103', 'DAIF4403B108206', 'NSIF4403C105304', 'AYIF4403D102406', 'CFIF4403E104107', 'DHIF4403F105105', 'DAIF4951A106307', 'HTIF4952A107108', 'CFIF4958A102103', 'AWIF4405A501205', 'AWIF4405B105209', 'ASIF4405C105402', 'BAIF4405D302308', 'BAIF4405E301306', 'BAIF4405F108202', 'JLIF4405I105302', 'VHIF4604A102404', 'VHIF4604B104509', 'VHIF4604C105407', 'AWIF4604D106404', 'AWIF4604E107109', 'DZIF4604I101304', 'ASIF4922A301106', 'JLIF4921A302104', 'VHIF4304A101202', 'DZIF4304I108208', 'HFIF4601A102203', 'HFIF4602B105304', 'SAIF4603C302205', 'SAIF4604D301501', 'ABIF4605I302107', 'DHIF4935A302407', 'IMIF4933A104301', 'SAIF4934A102106', 'SAIF4502A102403', 'ABIF4502I103307', 'RLIF4982A101508', 'DAIF4986A301105', 'IMIF4985A501206', 'IMTI4411A102309', 'IMTI4411A105108', 'ABTI4411I302403', 'MMIF4914A301109', 'ABIF4401E102202']
    
    list_skpb =  ['SFUG9999A999101', 'SFUG9999B999103', 'SWUG9998A998107', 'SIUG9997A997201', 'SMUG9996A996203', 'SSUG9995A999207', 'SMUG9996B996209', 'UGUG9994A994209', 'SFUG9999C999301', 'SFUG9999D999303', 'SWUG9998B998305', 'SSUG9995B995307', 'SMUG9996C996403', 'UGUG9994B994405', 'SIUG9997B997501', 'SNUG9993A993503', 'SNUG9993B993504']
    x = 0
    y = 0
    z = 0 
    p = 0
    q=0
    sesi_tesisa = []
    kemungkinan_sesi = []
    print("Banyak individu ", len(individu))
    for i in range(len(sesi)):
        for j in range(len(data_ruangan)):
            kemungkinan_sesi.append(data_ruangan[j] + sesi[i])

    print("Kemungkinan sesi ", len(kemungkinan_sesi))    
    for i in range(len(individu)):
        cnt_day = 0
        # if individu[i][9:15] 
        for j in range(i+1,len(individu)):
            if individu[i][0:9] != individu[j][0:9]:
                # First constraint: Dosen yang sama tidak bisa mengajar 2 MK di waktu yang sama
                if individu[i][0:2] == individu[j][0:2]: # Sama dosen
                    if abs(int(individu[i][12:15]) - int(individu[j][12:15])) < 2: # Sama hari sesi
                        x = x + 1
                        print("X: " + individu[i] + " " + individu[j] ,int(individu[i][12:15]) , int(individu[j][12:15]))
                # Second constraint: Ruangan yang sama tidak dapat dipakai di waktu yang sama
                if individu[i][9:12] == individu[j][9:12]: # Sama ruangan
                    if abs(int(individu[i][12:15]) - int(individu[j][12:15])) < 2: # Sama hari sesi
                        y = y + 1
                        print("Y: " + individu[i] + " " + individu[j] ,int(individu[i][12:15]) , int(individu[j][12:15]))
                
                # Third constraint: Satu dosen maksimal mengajar 2x sehari
                if individu[i][0:2] == individu[j][0:2]: # Sama dosen
                    if individu[i][12] == individu[j][12]: # Sama hari
                        cnt_day = cnt_day + 1
                        # print("Z: " + individu[i] + " " + individu[j] ,int(individu[i][12]) , int(individu[j][12]))
                if cnt_day > 2:
                    cnt_day = cnt_day - 2
                    z = z + cnt_day
                
        p = p + skpbConstrain(individu[i], list_skpb)
        q = q + prefrensiConstraint(individu[i])
    

    # print("Kemungkinan sesi:\n", kemungkinan_sesi[:len(individu)])
    isincounter = 0
    for i in range(len(kemungkinan_sesi)):
        isincounter = 0
        for j in range(len(individu)):
            if individu[j][9:15] == kemungkinan_sesi[i]:
                isincounter = isincounter + 1
        for j in range(len(list_skpb)):
            if list_skpb[j][9:15] == kemungkinan_sesi[i] :
                isincounter = isincounter + 1
        if isincounter == 0:
            sesi_tesisa.append(kemungkinan_sesi[i])
        
    # sesi_ambil = random.sample(sesi_tesisa, len(individu))
    print (x,y,z,p,q)
    total = x + y +z + p + q
    print("Banyak sesi tersisa: ",len(sesi_tesisa))
    # print ("Sesi tersisa\n", sesi_tesisa)

main()