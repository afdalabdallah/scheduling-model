import random

def skpbConstrain(gen, list_skpb):
    pnow = 0
    for i in range(len(list_skpb)):
        # Fourth Constraint: Sesi SKPB dan jurusan minimal 1 jam
        if gen[2:4] == "SK":
            if abs(int(gen[12:15]) - int(list_skpb[i][12:15])) < 2:
                pnow = pnow + 1
                print("P: " + gen )
    return pnow

dosenPrefrensiDict = {'SD': ['101', '102', '103', '104', '201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404', '501', '502', '503', '504'], 'RA': ['105', '106', '107', '108', '109', '110', '205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410', '505', '506', '507', '508', '509', '510'], 'RM': ['101', '102', '103', '104', '201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404', '501', '502', '503', '504'], 'WS': ['105', '106', '107', '108', '205', '206', '207', '208', '305', '306', '307', '308', '405', '406', '407', '408', '505', '506', '507', '508'], 'TA': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'BM': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'BJ': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408'], 'BH': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'AM': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408'], 'HB': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', 
'509', '510'], 'HS': ['301', '302', '303', '304', '401', '402', '403', '404'], 'BS': ['105', '106', '107', '108', '109', '110', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410'], 'YP': ['205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410'], 'DP': ['201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404'], 'AR': ['301', '302', '303', '304', '305', '306', '307', '308'], 'RL': ['301', '302', '303', '304', '305', '306', '307', '308'], 'DS': ['105', '106', '107', '108', '205', '206', '207', '208', '305', '306', '307', '308', '405', '406', '407', '408'], 'FB': ['201', '202', '203', '204', '205', '206', '207', '208', 
'209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310'], 'AB': ['105', '106', '107', '108', '109', '110', '205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410', '505', '506', '507', '508', '509', '510'], 'IS': ['105', '106', '107', '108', '109', '110', '205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', 
'407', '408', '409', '410', '505', '506', '507', '508', '509', '510'], 'RR': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'AL': ['101', '102', 
'103', '104', '105', '106', '107', '108', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408'], 'MN': ['101', '102', '103', '104', '201', '202', '203', '204', '301', '302', '303', '304', '401', '402', '403', '404', '501', '502', '503', '504'], 'MK': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', 
'301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'KR': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'SC': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'OJ': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'ML': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'RJ': ['205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310', '405', '406', '407', '408', '409', '410'], 'MR': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'RN': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', 
'205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410'], 'SR': ['205', '206', '207', '208', '209', '210', '305', '306', '307', '308', '309', '310'], 'UY': ['209', '210', '309', '310', '409', '410'], 'DO': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'ST': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'DA': ['205', '206', '207', '208', '305', '306', '307', '308', '405', '406', '407', '408'], 'NS': ['301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'AY': ['209', '210'], 'CF': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'DH': ['105', '106', '107', '108', '109', '110', '305', '306', '307', '308', '309', '310', '505', '506', '507', '508', '509', '510'], 'HT': ['209', '210', '309', '310'], 'AW': ['201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'AS': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'BA': ['101', '102', '103', '104', '105', '106', '107', '108', '201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308', '401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'JL': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210'], 'VH': ['401', '402', '403', '404', '405', '406', '407', '408', '501', '502', '503', '504', '505', '506', '507', '508'], 'DZ': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'HF': ['201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410'], 'SA': ['201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'DH ': ['101', 
'102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'IM': ['201', '202', '203', '204', '205', '206', '207', '208', '301', '302', '303', '304', '305', '306', '307', '308'], 'MM': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SF': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SW': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SI': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', 
'206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SM': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SS': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'UG': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', 
'404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510'], 'SN': ['101', '102', '103', '104', '105', '106', '107', '108', '109', '110', '201', '202', '203', '204', '205', '206', '207', '208', '209', '210', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '501', '502', '503', '504', '505', '506', '507', '508', '509', '510']}
def prefrensiConstraint(gen):
    qnow = 0
    print(gen)
    if gen[12:15] not in dosenPrefrensiDict[gen[0:2]]:
        qnow = qnow + 1
    return qnow
def main():
    data_ruangan=[
        "101",
        "102",
        "103",
        "104",
        "105",
        "501",
        "106",
        "107",
        "108",
        "301",
        "302",
        "111",
        "112"
    ]


# First number means # day of the week
# The rest is the session of the day
# Ex. 301 = Wednesday, Session 1
# Ex. 110 = Monday, Session 10
# A session means an hour, Session 1 starts from 7.00
# That means Sesssion 2 is 8.00, Session 3 is 9.00, and so on.
    sesi=[]
    for i in range(1,6):
        for j in range(1,10,2):
            temp_sesi=""
            if j < 10:
                sesi.append(str(i)+"0"+str(j))
            else:
                sesi.append(str(i)+str(j))
    individu = ['SDIF4201A302303', 'RAIF4201A102305', 'RAIF4201I111101', 'RAIF4947A104203', 'RMIF4602A107309', 'RMIF4602B301501', 'WSIF4201C501103', 'WSIF4201D101107', 'WSIF4201E108405', 'WSIF4402A112403', 'TAIF4201F106503', 'TAIF4201G103307', 'BMIF4402I112107', 'BJIF4402B106101', 'BJIF4602C101207', 
'BHIF4602I111507', 'AMIF4402C104307', 'AMIF4402D107109', 'HBIF4402E301203', 'HBIF4402F501109', 'HSIF4602D101109', 'HSIF4945A108303', 'BSIF4913A112407', 'BSIF4701A106105', 'BSIF4701I103405', 'BSIF4602E112309', 'YPIF4101A302405', 'YPIF4202A102401', 'YPIF4202B102407', 'DPIF4202C501303', 'DPIF4202I103109', 'DPIF4957A107105', 'ARIF4202D111301', 'ARIF4202E103509', 'RLIF4401A108309', 'RLIF4401B103401', 'RLIF4401C104207', 'RLIF4902A103105', 'DSIF4202F112401', 'DSIF4202G106405', 'DSIF4404A101301', 'FBIF4605A111301', 'FBIF4605B104407', 'FBIF4504A107207', 'FBIF4406A301303', 'FBIF4406B501501', 'ABIF4401D101305', 'ABIF4401E108209', 'ABIF4401I112409', 'ISIF4401F106109', 'ISIF4401G103307', 'ISIF4401H112103', 'ISIF4504I106507', 'RRIF4963A101409', 'ALIF4964F111401', 'ALIF4603A104507', 'ALIF4406C107103', 'ALIF4406I301109', 'MNIF4605C501103', 'MNIF4605I101307', 'MNIF4404B108203', 'MKIF4404I112201', 'MNIF4966A106107', 'KRIF4404C103107', 'KRTI4411A112503', 'SCIF4404D106203', 'SCIF4403I101307', 'SCTI4411B111305', 'OJIF4946A104409', 'MLIF4101A107307', 'RJIF4605D301307', 'RJIF4605E501403', 'MRIF4903A101407', 'RNIF4404E108105', 'SRIF4404F108203', 'RNIF4603B301503', 'RNIF4603C102309', 'UYIF4603D108401', 'UYIF4603E302303', 'DOIF4603F112301', 'RNIF4603I104405', 'STIF4406D112301', 'SRIF4406E105507', 'SRIF4406F106105', 'RJIF4971A111505', 'STIF4972A103305', 'DAIF4403A111403', 'DAIF4403B108201', 'NSIF4403C301203', 'AYIF4403D102307', 'CFIF4403E108405', 'DHIF4403F302403', 'DAIF4951A112107', 'HTIF4952A104303', 'CFIF4958A112207', 'AWIF4405A105101', 'AWIF4405B106509', 'ASIF4405C111205', 'BAIF4405D103101', 'BAIF4405E111407', 'BAIF4405F108201', 'JLIF4405I301407', 'VHIF4604A102201', 'VHIF4604B108303', 'VHIF4604C302307', 'AWIF4604D112409', 'AWIF4604E104503', 'DZIF4604I112505', 'ASIF4922A105305', 'JLIF4921A106303', 'VHIF4304A111203', 'DZIF4304I103201', 'HFIF4601A108203', 'HFIF4602B112105', 'SAIF4603C106507', 'SAIF4604D103509', 'ABIF4605I112509', 'DHIF4935A106405', 'IMIF4933A101103', 'SAIF4934A111109', 'SAIF4502A104103', 'ABIF4502I107507', 'RLIF4982A301403', 'DAIF4986A501401', 'IMIF4985A103205', 'IMTI4411A111201', 'IMTI4411A108501', 'ABTI4411I106103', 'MMIF4914A103109']
    
    list_skpb =  ['SFUG9999A999101', 'SFUG9999B999103', 'SWUG9998A998107', 'SIUG9997A997201', 'SMUG9996A996203', 'SSUG9995A999207', 'SMUG9996B996209', 'UGUG9994A994209', 'SFUG9999C999301', 'SFUG9999D999303', 'SWUG9998B998305', 'SSUG9995B995307', 'SMUG9996C996403', 'UGUG9994B994405', 'SIUG9997B997501', 'SNUG9993A993503', 'SNUG9993B993504']
    x = 0
    y = 0
    z = 0 
    p = 0
    q=0
    sesi_tesisa = []
    kemungkinan_sesi = []
    print("Banyak individu ", len(individu))
    for i in range(len(sesi)):
        for j in range(len(data_ruangan)):
            kemungkinan_sesi.append(data_ruangan[j] + sesi[i])

    print("Kemungkinan sesi ", len(kemungkinan_sesi))    
    for i in range(len(individu)):
        cnt_day = 0
        # if individu[i][9:15] 
        for j in range(i+1,len(individu)):
            if individu[i][0:9] != individu[j][0:9]:
                # First constraint: Dosen yang sama tidak bisa mengajar 2 MK di waktu yang sama
                if individu[i][0:2] == individu[j][0:2]: # Sama dosen
                    if abs(int(individu[i][12:15]) - int(individu[j][12:15])) < 2: # Sama hari sesi
                        x = x + 1
                        print("X: " + individu[i] + " " + individu[j] ,int(individu[i][12:15]) , int(individu[j][12:15]))
                # Second constraint: Ruangan yang sama tidak dapat dipakai di waktu yang sama
                if individu[i][9:12] == individu[j][9:12]: # Sama ruangan
                    if abs(int(individu[i][12:15]) - int(individu[j][12:15])) < 2: # Sama hari sesi
                        y = y + 1
                        print("Y: " + individu[i] + " " + individu[j] ,int(individu[i][12:15]) , int(individu[j][12:15]))
                
                # Third constraint: Satu dosen maksimal mengajar 2x sehari
                if individu[i][0:2] == individu[j][0:2]: # Sama dosen
                    if individu[i][12] == individu[j][12]: # Sama hari
                        cnt_day = cnt_day + 1
                        # print("Z: " + individu[i] + " " + individu[j] ,int(individu[i][12]) , int(individu[j][12]))
                if cnt_day > 2:
                    cnt_day = cnt_day - 2
                    z = z + cnt_day
                
        p = p + skpbConstrain(individu[i], list_skpb)
        q = q + prefrensiConstraint(individu[i])
    

    # print("Kemungkinan sesi:\n", kemungkinan_sesi[:len(individu)])
    isincounter = 0
    for i in range(len(kemungkinan_sesi)):
        isincounter = 0
        for j in range(len(individu)):
            if individu[j][9:15] == kemungkinan_sesi[i]:
                isincounter = isincounter + 1
        for j in range(len(list_skpb)):
            if list_skpb[j][9:15] == kemungkinan_sesi[i] :
                isincounter = isincounter + 1
        if isincounter == 0:
            sesi_tesisa.append(kemungkinan_sesi[i])
        
    # sesi_ambil = random.sample(sesi_tesisa, len(individu))
    print (x,y,z,p,q)
    total = x + y +z + p + q
    print("Banyak sesi tersisa: ",len(sesi_tesisa))
    # print ("Sesi tersisa\n", sesi_tesisa)

main()